  - name: Configure Git
    run: |
      git config user.name "github-actions"
      git config user.email "github-actions@github.com"

  - name: Replace project name placeholder
    run: |
      # This command finds all files in the repository and uses 'sed' to replace
      # the placeholder '{{PROJECT_NAME}}' with the name provided in the workflow input.
      # The sed delimiter is changed from '/' to '|' to safely handle path names.
      find . -type f -not -path './.git/*' -exec sed -i "s|{{PROJECT_NAME}}|${{ github.event.inputs.new_project_name }}|g" {} +
      
  - name: Create a pull request with the new name
    uses: peter-evans/create-pull-request@v6
    with:
      title: 'Update project name to "${{ github.event.inputs.new_project_name }}"'
      commit-message: 'feat: Update project name to ${{ github.event.inputs.new_project_name }}'
      body: |
        This pull request automatically updates all instances of the project name
        placeholder (`{{PROJECT_NAME}}`) with the new name you specified.
      branch: update-project-name-${{ github.run_number }}
      token: ${{ secrets.GITHUB_TOKEN }}
